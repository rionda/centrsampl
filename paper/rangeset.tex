\section{A range set for shortest paths}\label{sec:rangeset}
We now define a range set for shortest paths of a graph $G=(V,E)$, and present 
an upper bound to its VC-dimension. We show that this upper bound is strict. We
use the range set and the bound in our algorithm for estimating the betweenness
centrality of vertices of the graph.

The range set $\range_G$ is defined on the set $\mathbb{S}_G$ of all shortest
paths between vertices of $G$. It contains, for each vertex $v\in V$, the set
$\mathcal{T}_v$  of shortest paths that go through $v$:
\[
\range_G = \{T_v ~:~ v\in V\}\enspace.
\]

\begin{lemma}\label{lem:vcdimuppbound}
  Given a graph $G=(V,E)$ with vertex-diameter $\Delta_G$, the range set
  $\range_G$ associated to the shortest paths in $G$ has VC-dimension
  $\VC(\range_G)$ at most $\lfloor\log_2\Delta_G\rfloor+1$.
\end{lemma}

\begin{proof}
Let $k>\lfloor\log_2\Delta_G\rfloor+1$ and assume for the sake of contradiction
that $\VC(\range_G)=k$. From the definition of the VC-dimension there is a set
$Q\subseteq\mathbb{S}_G$ of size $k$ that is shattered by $\range_G$. Let $p$ be
an element of $Q$. The path $p$ is contained in $2^{k-1}$ non-empty subsets of
$Q$. Let us label this non-empty subsets of $Q$ containing $p$ as
$S_1,\dotsc,S_{2^{k-1}}$, where the labelling is arbitrary.
Given that $Q$ is shattered then, for each set $S_i$ there must be a range $R_i$ in
$\range_G$ such that $S_i=Q\cap R_i$. Since all the $S_i$'s are
different from each other, then all the $R_i$'s must be different from each
other. Given that $p$ belongs to each $S_i$, then $p$ must also belong to each
$R_i$, that is, there are $2^{k-1}$ distinct ranges in $\range_G$ containing
$p$. But $p$ belongs to the ranges corresponding to the vertices in $p$. This means that the number of ranges
in $\range_G$ that $p$ belongs to is equal to $|p|$. But $|p|\le\Delta_G$, by definition of $\Delta_G$, so $p$
can belong to at most $\Delta_G$ ranges from $\range_G$. Given that
$2^{k-1}>\Delta_G$, we reached a contradiction and there cannot be $2^{k-1}$
distinct ranges containing $p$, hence not all the sets $S_i$ can be expressed as
$Q\cap R_i$ for some $R_i\in\range_G$, but then $Q$ cannot be shattered and
$\VC(\range_G)\le\lfloor\log_2\Delta_G\rfloor+1$.%\qed
\end{proof}

In the restricted case when the graph is undirected and every pair of vertices
has one or no shortest path between them, the upper bound can be improved.
\begin{lemma}\label{lem:vcdimuppboundunique}
  Given an undirected graph $G=(V,E)$ such that $|\mathcal{S}_{uv}|\le1$ for all
  pairs $(u,v)\in V\times V$, the range set $\range_G$ associated to the
  shortest paths in $G$ has VC-Dimension $\VC(\range_G)$ at most $2$.
\end{lemma}

\begin{proof}
  Assume that $\VC(\range_G)>2$, then there must be a set $Q=\{p_1,p_2,p_3\}$ of three
  shortest paths that can be shattered. Hence, there must be a vertex $z$ such that
  $\mathcal{T}_{z}\cap Q=Q$, and three vertices $w,x,y$ such
  that $\mathcal{T}_{w}\cap Q=\{p_1,p_2\}$, $\mathcal{T}_{x}\cap
  Q=\{p_1,p_3\}$, and $\mathcal{T}_{y}\cap Q=\{p_2,p_3\}$. Let $\mu:V\rightarrow
  [1,n]$ be an arbitrary bijection. We need to consider two
  cases (all the other cases follow by simmetry): either
  1.~$\mu(w)<\mu(x)<\mu(y)<\mu(z)$ or 2.~$\mu(w)<\mu(x)<\mu(z)<\mu(y)$.

  Consider the first case. The path $p_1$ passes through $w$, then (not
  necessarily consecutively) through $x$, and finally through $z$, without
  passing through $y$. The path $p_2$ passes through $w$, then $y$ (without
  passing through $x$), then $z$. The path $p_3$ passes through $x$ without
  passing through $w$, then goes through $y$ and through $z$. This implies that
  path $p_1$ and $p_3$ both pass through $x$ and through $z$, but while moving
  from $x$ through $z$ they are not overlapping, given that $p_3$ passes through
  $y$ and $p_1$ does not. Given that both $p_1$ and $p_3$ are shortest
  paths, every subpath in them is a shortest path. But this would mean that
  there are two shortest paths between $x$ and $z$, one going through $y$
  (a subpath of $p_3$) and the other not going through $y$ (a subpath of $p_1$).
  This is a contradiction, hence there cannot be such nodes $w,x,y,z$ and $Q$
  cannot be shattered.

  Consider now the second case. The path $p_1$ passes through $w$, then through
  $x$, then through $z$, and it does not pass through $y$. Path $p_2$ goes
  through $w$, then through $z$ without going through $x$, and then through $y$.
  Path $p_3$ goes through $x$ without going through $w$, then goes through $z$,
  and eventually through $y$. This implies that $p_1$ and $p_2$ both go through
  $w$ and through $z$ but following different paths, given that $p_1$ goes
  through $x$ and $p_2$ does not. We reached a contradiction, because these
  two different paths between $w$ and $z$ cannot be both shortest paths, given
  that by hypothesis there must be a single shortest path between $w$ and $z$.
  Hence there cannot be such nodes $w,x,y,z$ and $Q$ cannot be shattered.  

  Given that it is impossible to shatter a set of size $3$, then
  $\VC(\range_G)\le 2$.
\end{proof}

The bound presented in Lemma~\ref{lem:vcdimuppbound} is strict in the sense that
for each $d>0$ we can build a graph $G_d$ with vertex-diameter $d$ and such
that the range set associated to the set of shortest path of $G_d$ has
VC-dimension exactly $\lfloor\log_2(d+1)\rfloor+1$.

\begin{lemma}
  Given $d>0$ there exists a graph $G$ with edge-diameter $d$ and such that
  $\VC(\range_G)=\lfloor\log_2 d\rfloor+1$.
\end{lemma}

\begin{proof}
  \XXX TBD Remember to take care of the case $d=1$.
\end{proof}

